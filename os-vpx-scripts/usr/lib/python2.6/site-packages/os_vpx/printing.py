import re


ESCAPE_SEQUENCE_RE = re.compile(r'\x1B\[[^A-Za-z]*[A-Za-z]') 


def columnar_display(table, scriptable=False):
    if scriptable:
       for row in table:
          print ' '.join([str(x) for x in row])
       return

    cols = 0
    deltas = {}
    for row in table:
        n = len(row)
        if n > cols:
            cols = n
        deltas[id(row)] = {}
    widths = {}
    for i in xrange(0, cols):
        widths[i] = 0
    for row in table:
        i = 0
        for item in row:
            item = str(item)
            it = ESCAPE_SEQUENCE_RE.sub('', item)
            n = len(str(it))
            if n > widths[i]:
                widths[i] = n
            deltas[id(row)][i] = len(item) - len(it) 
            i += 1
    for row in table:
        i = 0
        for item in row:
            print '%-*s  ' % (widths[i] + deltas[id(row)][i], item),
            i += 1
        print ''
